(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{201:function(e,t,n){},203:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),s=n(58),o=n.n(s),c=n(61),i=n(2),l=n.n(i),u=n(7),d=n(9),f=n(10),h=n(16),p=n(11),m=n(12),v=n(3),b=n(59),g=n.n(b),w=(n(69),"https://chrome.google.com/webstore/detail/ibnejdfjmmkpcnlpebklmnkoeoihofec/"),y=r.a.createElement("div",{className:"logo"},r.a.createElement("img",{src:g.a,alt:"TronLink logo"})),x=function(){window.open(w,"_blank")},k=function(e){var t=e.installed;return void 0!==t&&t?r.a.createElement("div",{className:"tronLink hover",onClick:x},r.a.createElement("div",{className:"info"},r.a.createElement("h1",null,"Log in Required"),r.a.createElement("p",null,"TronLink is installed but you must first log in. Open TronLink from the browser bar and set up your first wallet or decrypt a previously-created wallet.")),y):r.a.createElement("div",{className:"tronLink",onClick:x},r.a.createElement("div",{className:"info"},r.a.createElement("h1",null,"TronLink Required"),r.a.createElement("p",null,"To create a post or tip others you must install TronLink. TronLink is a TRON wallet for the browser that can be ",r.a.createElement("a",{href:w,target:"_blank",rel:"noopener noreferrer"},"installed from the Chrome Webstore"),". Once installed, return back and refresh the page.")),y)},O=n(60),j=n.n(O),E={tronWeb:!1,contract:!1,setTronWeb:function(){var e=Object(u.a)(l.a.mark(function e(t){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.tronWeb=t,e.next=3,t.contract().at("TV8a5PxfrRDVB5dtRm3x5PUJWmRHzaNTU2");case 3:this.contract=e.sent;case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},R=n(6),T=n.n(R);function S(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(v.a)(e);if(t){var r=Object(v.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(m.a)(this,n)}}r.a.Component;function W(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(v.a)(e);if(t){var r=Object(v.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(m.a)(this,n)}}r.a.Component;function _(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(v.a)(e);if(t){var r=Object(v.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(m.a)(this,n)}}var C=function(e){Object(p.a)(n,e);var t=_(n);function n(e){var a;return Object(d.a)(this,n),(a=t.call(this,e)).state={value:""},a.handleChange=a.handleChange.bind(Object(h.a)(a)),a}return Object(f.a)(n,[{key:"handleChange",value:function(e){this.setState({value:e.target.value})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-body"},r.a.createElement("h6",null,"My Tron Address"),r.a.createElement("h3",null,this.props.address),r.a.createElement("form",{onSubmit:function(t){t.preventDefault(),e.props.multiSendTrx(e.state.value)}},r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{type:"text",value:this.state.value,onChange:this.handleChange,id:"referal_address",placeholder:"Enter Referral Address",name:"referal_address"})),r.a.createElement("button",{type:"submit",className:"btn btn-primary m-3"},"Register"),r.a.createElement("hr",null)),r.a.createElement("button",{className:"btn btn-primary m-3",onClick:this.props.login},"Login")))}}]),n}(r.a.Component);function N(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(v.a)(e);if(t){var r=Object(v.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(m.a)(this,n)}}var L=function(e){Object(p.a)(n,e);var t=N(n);function n(){return Object(d.a)(this,n),t.apply(this,arguments)}return Object(f.a)(n,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(C,{candidates:this.props.candidates,multiSendTrx:this.props.multiSendTrx,address:this.props.address,login:this.props.login}),r.a.createElement("hr",null))}}]),n}(r.a.Component);n(201);function V(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,a=Object(v.a)(e);if(t){var r=Object(v.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(m.a)(this,n)}}var B=function(e){Object(p.a)(n,e);var t=V(n);function n(e){var a;return Object(d.a)(this,n),(a=t.call(this,e)).state={candidates:[],address:"",hasVoted:!1,loading:!1,isRegisterred:!1,error:null,dataFetched:!1,data:null,owner:null,isLoggedin:!1,user_data:null,tronrate:null,tronWeb:{installed:!1,loggedIn:!1}},a.voteCandidate=a.voteCandidate.bind(Object(h.a)(a)),a.multiSendTrx=a.multiSendTrx.bind(Object(h.a)(a)),a}return Object(f.a)(n,[{key:"componentDidMount",value:function(){var e=Object(u.a)(l.a.mark(function e(){var t=this;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading:!0}),e.next=3,new Promise(function(e){var n={installed:!!window.tronWeb,loggedIn:window.tronWeb&&window.tronWeb.ready};if(n.installed)return t.setState({tronWeb:n}),e();var a=0,r=setInterval(function(){if(a>=10){return window.tronWeb=new j.a("https://api.trongrid.io","https://api.trongrid.io","https://api.trongrid.io"),t.setState({tronWeb:{installed:!1,loggedIn:!1}}),clearInterval(r),e()}if(n.installed=!!window.tronWeb,n.loggedIn=window.tronWeb&&window.tronWeb.ready,!n.installed)return a++;t.setState({tronWeb:n}),e()},100)});case 3:return this.state.tronWeb.loggedIn||(window.tronWeb.defaultAddress={hex:window.tronWeb.address.toHex("TXqqHYESMNUUXms7YT9hDqAr1pdyzMig4E"),base58:"TXqqHYESMNUUXms7YT9hDqAr1pdyzMig4E"},window.tronWeb.on("addressChanged",function(){t.state.tronWeb.loggedIn||t.setState({tronWeb:{installed:!0,loggedIn:!0,address:window.tronWeb.defaultAddress}})})),e.next=6,E.setTronWeb(window.tronWeb);case 6:this.fetchData(),this.startEventListener(),this.setState({loading:!1}),this.fetchOwner(),this.get_coin_rate();case 11:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"startEventListener",value:function(){E.contract.Multisended().watch(function(e){if(e)return console.log("Failed to bind the event",e);T()({title:"User Registered Successfully",type:"success"})})}},{key:"startRegisterEventListener",value:function(){var e=this;E.contract.multiSendTrx().watch(function(t,n){if(t)return console.log("Failed to bind the event",t);T()({title:"User Registered Successfully",type:"success"}),e.activate_user(n.sender)})}},{key:"fetchOwner",value:function(){var e=Object(u.a)(l.a.mark(function e(){var t;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.contract.owner().call();case 2:t=e.sent,console.log("owner",t),this.setState({owner:t});case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"fetchData",value:function(){var e=Object(u.a)(l.a.mark(function e(){var t,n,a,r,s;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.tronWeb.defaultAddress.base58,console.log("my address",t),e.next=4,E.contract.candidatecount().call();case 4:n=e.sent.toNumber(),console.log("CandidateCount",n),a=1;case 7:if(!(a<=n)){e.next=18;break}return e.next=10,E.contract.candidates(a).call();case 10:r=e.sent,console.log("candidate_tmp",r),(s=Object(c.a)(this.state.candidates)).push({id:r.id.toNumber(),name:r.name,voteCount:r.voteCount.toNumber()}),this.setState({candidates:s});case 15:a++,e.next=7;break;case 18:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"register",value:function(){var e=Object(u.a)(l.a.mark(function e(t,n){var a,r,s,o,c,i,u,d,f,h,p,m,v,b=this;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a="https://www.trondesire.io/api/register_api?sponcer_id="+t+"&user_id="+n,console.log(a),e.next=4,fetch(a);case 4:return r=e.sent,e.next=7,r.json();case 7:s=e.sent,console.log(s.message),this.setState({data:s}),this.setState({dataFetched:!0}),1==this.state.data.success?(o=[this.state.data.data.cf_address,this.state.data.data.og_refer,this.state.data.data.owner],this.get_coin_rate(),c=this.state.tronrate,console.log("Trx rate",c),i=this.state.data.data.cf_amt,u=this.state.data.data.og_amt,d=this.state.data.data.admin_amt,f=parseFloat(1e6*i,10),h=parseFloat(1e6*u,10),p=parseFloat(1e6*d,10),console.log(f),m=[f,h,p],v=f+h+p,console.log(o),console.log(m),E.contract.multisendEther(o,m).send({shouldPollResponse:!0,callValue:v}).then(function(e){b.activate_user(n)}).catch(function(e){b.failed_payment(n)})):T()({title:this.state.data.message,type:"error"});case 12:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"get_coin_rate",value:function(){var e=Object(u.a)(l.a.mark(function e(){var t,n,a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t="https://min-api.cryptocompare.com/data/price?fsym=usd&tsyms=trx",console.log(t),e.next=4,fetch(t);case 4:return n=e.sent,e.next=7,n.json();case 7:a=e.sent,console.log(a.TRX),this.setState({tronrate:a.TRX});case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"failed_payment",value:function(){var e=Object(u.a)(l.a.mark(function e(t){var n,a,r;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n="https://www.trondesire.io/api/deleteuser?user_id="+t,console.log(n),e.next=4,fetch(n);case 4:return a=e.sent,e.next=7,a.json();case 7:r=e.sent,this.setState({data:r}),this.setState({dataFetched:!0}),1==this.state.data.success&&T()({title:this.state.data.message,type:"error"});case 11:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"activate_user",value:function(){var e=Object(u.a)(l.a.mark(function e(t){var n,a,r;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n="https://www.trondesire.io/api/activateuser?user_id="+t,console.log(n),e.next=4,fetch(n);case 4:return a=e.sent,e.next=7,a.json();case 7:r=e.sent,this.setState({data:r}),this.setState({dataFetched:!0}),1==this.state.data.success&&T()({title:this.state.data.message,type:"success"});case 11:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"multiSendTrx",value:function(e){var t=window.tronWeb.defaultAddress.base58;this.register(e,t)}},{key:"login",value:function(){var e=Object(u.a)(l.a.mark(function e(){var t,n,a,r,s;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.tronWeb.defaultAddress.base58,n="https://www.trondesire.io/api/fetch_user?user_id="+t,console.log(n),e.next=5,fetch(n);case 5:return a=e.sent,e.next=8,a.json();case 8:1==(r=e.sent).success?(T()({title:r.message,type:"success"}),s="https://www.trondesire.io/api/login?user_id="+t,window.location=s):T()({title:r.message,type:"error"});case 10:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},{key:"multiSendTrx_demo",value:function(e){var t=[5e6,1e7];console.log(t),E.contract.multisendEther(["TVWFvKMqVPymmDhn8hPHuB95UkKjVpBCGn","TXk8MdS9Umc5qivAUfEAYTGPv7v66RJrYX"],t).send({shouldPollResponse:!0,callValue:15e6}).then(function(e){return T()({title:"Vote Casted",type:"success"})}).catch(function(e){return T()({title:"Vote Failed",type:"error"})})}},{key:"voteCandidate",value:function(e){E.contract.vote(e).send({shouldPollResponse:!0,callValue:0}).then(function(e){return T()({title:"Vote Casted",type:"success"})}).catch(function(e){return T()({title:"Vote Failed",type:"error"})}),this.setState({hasVoted:!0})}},{key:"render",value:function(){return this.state.tronWeb.installed?this.state.tronWeb.loggedIn?r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-lg-12 text-center"},r.a.createElement("h1",null," Tron Desire "),this.state.loading?r.a.createElement("p",{className:"text-center"}," Loading... "):r.a.createElement(L,{candidates:this.state.candidates,hasVoted:this.state.hasVoted,castVote:this.voteCandidate,multiSendTrx:this.multiSendTrx,login:this.login,address:window.tronWeb.defaultAddress.base58})," ")," "):r.a.createElement(k,{installed:!0}):r.a.createElement(k,null)}}]),n}(r.a.Component);o.a.render(r.a.createElement(B,null),document.getElementById("root"))},59:function(e,t,n){e.exports=n.p+"static/media/TronLinkLogo.d3a8f115.png"},62:function(e,t,n){e.exports=n(203)},69:function(e,t,n){},96:function(e,t){},97:function(e,t){}},[[62,2,1]]]);
//# sourceMappingURL=main.c93473c0.chunk.js.map